@model IEnumerable<KosovaDoganaModerne.Modelet.Entitetet.ShpenzimiTransportit>

@{
    ViewData["Title"] = "Shpenzimet e Transportit - Raport";
    var llojiTransportit = ViewData["LlojiTransportit"] as string;
    
    var additionalParams = !string.IsNullOrEmpty(llojiTransportit) ? $"?llojiTransportit={llojiTransportit}" : "";
    
    ViewData["PrintController"] = "Raportet";
    ViewData["PrintAction"] = "ShpenzimetTransportit";
    ViewData["AdditionalParams"] = additionalParams;
}

<div class="container-fluid mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2><i class="fas fa-truck"></i> Raporti i shpenzimeve të transportit</h2>
            <p class="text-muted mb-0">
                @if (!string.IsNullOrWhiteSpace(llojiTransportit))
                {
                    <text>Lloji i transportit: <strong>@llojiTransportit</strong></text>
                }
                else
                {
                    <text>Të gjitha llojet e transportit</text>
                }
            </p>
        </div>
        <div class="d-flex gap-2">
            <a asp-action="Index" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Kthehu
            </a>
            <partial name="_PrintExcelButtons" />
        </div>
    </div>

    @if (Model != null && Model.Any())
    {
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-secondary">
                            <tr>
                                <th>Nr.</th>
                                <th>Origjina</th>
                                <th>Destinacioni</th>
                                <th>Lloji transportit</th>
                                <th>Çmimi/Njësi</th>
                                <th>Njësia</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{ var nr = 1; }
                            @foreach (var shpenzim in Model.OrderBy(s => s.VendiOrigjines).ThenBy(s => s.VendiDestinacionit))
                            {
                                <tr>
                                    <td>@nr</td>
                                    <td><strong>@shpenzim.VendiOrigjines</strong></td>
                                    <td><strong>@shpenzim.VendiDestinacionit</strong></td>
                                    <td>
                                        @if (shpenzim.LlojiTransportit == "Tokësor")
                                        {
                                            <i class="fas fa-truck text-primary"></i>
                                        }
                                        else if (shpenzim.LlojiTransportit == "Ajror")
                                        {
                                            <i class="fas fa-plane text-info"></i>
                                        }
                                        else if (shpenzim.LlojiTransportit == "Detar")
                                        {
                                            <i class="fas fa-ship text-primary"></i>
                                        }
                                        else if (shpenzim.LlojiTransportit == "Hekurudhor")
                                        {
                                            <i class="fas fa-train text-secondary"></i>
                                        }
                                        @shpenzim.LlojiTransportit
                                    </td>
                                    <td class="text-end">@shpenzim.CmimiPerNjesi.ToString("N2") @shpenzim.Valuta</td>
                                    <td>@shpenzim.NjesiaMatese</td>
                                </tr>
                                nr++;
                            }
                        </tbody>
                        <tfoot>
                            <tr class="table-light">
                                <td colspan="6">
                                    <strong>Totali i shpenzimeve:</strong> @Model.Count() ruta transporti
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>

        <div class="alert alert-info mt-3 no-print">
            <i class="fas fa-info-circle"></i>
            <strong>Shënim:</strong> Të gjitha eksportimet dhe printimet e këtij raporti logohen automatikisht për auditim të sigurisë.
        </div>

        <div class="mt-3 no-print">
            <small class="text-muted">
                Gjeneruar më: @DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss")
            </small>
        </div>
    }
    else
    {
        <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle"></i> Nuk ka shpenzime transporti për kriteret e zgjedhura.
        </div>
    }
</div>

<style>
    @@media print {
        .btn, .no-print { display: none !important; }
        body { font-size: 12px; }
        .table { font-size: 11px; }
    }
</style>
